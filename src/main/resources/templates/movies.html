<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Movflx - Online Movies & TV Shows Template</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.png">
        <!-- Place favicon.ico in the root directory -->

		<!-- CSS here -->
<!--        <link rel="stylesheet" href="/static/css/bootstrap.min.css">-->
<!--        <link rel="stylesheet" href="/static/css/animate.min.css">-->
<!--        <link rel="stylesheet" href="/static/css/magnific-popup.css">-->
<!--        <link rel="stylesheet" href="/static/css/fontawesome-all.min.css">-->
<!--        <link rel="stylesheet" href="/static/css/owl.carousel.min.css">-->
<!--        <link rel="stylesheet" href="/static/css/flaticon.css">-->
<!--        <link rel="stylesheet" href="/static/css/odometer.css">-->
<!--        <link rel="stylesheet" href="/static/css/aos.css">-->
<!--        <link rel="stylesheet" href="/static/css/slick.css">-->
<!--        <link rel="stylesheet" href="/static/css/default.css">-->
<!--        <link rel="stylesheet" href="/static/css/style.css">-->
<!--        <link rel="stylesheet" href="/static/css/responsive.css">-->

        <!-- CSS here -->
        <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
        <link rel="stylesheet" th:href="@{/css/animate.min.css}">
        <link rel="stylesheet" th:href="@{/css/magnific-popup.css}">
        <link rel="stylesheet" th:href="@{/css/fontawesome-all.min.css}">
        <link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}">
        <link rel="stylesheet" th:href="@{/css/flaticon.css}">
        <link rel="stylesheet" th:href="@{/css/odometer.css}">
        <link rel="stylesheet" th:href="@{/css/aos.css}">
        <link rel="stylesheet" th:href="@{/css/slick.css}">
        <link rel="stylesheet" th:href="@{/css/default.css}">
        <link rel="stylesheet" th:href="@{/css/style.css}">
        <link rel="stylesheet" th:href="@{/css/responsive.css}">

    </head>
    <body>

<!--            <div th:each="movie:${reslist}" th:if="${reslist != null}">-->
<!--                <p th:text="${movie.title}"></p>-->
<!--            </div>-->

        <!-- preloader -->
        <div id="preloader">
            <div id="loading-center">
                <div id="loading-center-absolute">
                    <img src="https://themebeyond.com/html/movflx//img/preloader.svg" alt="">
                </div>
            </div>
        </div>
        <!-- preloader-end -->

		<!-- Scroll-top -->
        <button class="scroll-top scroll-to-target" data-target="html">
            <i class="fas fa-angle-up"></i>
        </button>
        <!-- Scroll-top-end-->

        <!-- header-area -->
        <header>
    <div id="sticky-header" class="menu-area transparent-header">
        <div class="container custom-container">
            <div class="row">
                <div class="col-12">
                    <div class="mobile-nav-toggler"><i class="fas fa-bars"></i></div>
                    <div class="menu-wrap">
                        <nav class="menu-nav show">
                            <div class="logo">
                                <a href="popular.html">
                                    <img src="/img/logo/logo.png" alt="Logo">
                                </a>
                            </div>
                            <div class="navbar-wrap main-menu d-none d-lg-flex">
                                <ul class="navigation">
                                    <li><a th:href="@{http://localhost:8080/movies/popular?pageNum=1&pageSize=10}">Home</a>
                                    </li>
                                    <li><a th:href="@{http://localhost:8080/movies/genre?genre=科幻&pageNum=1&pageSize=10}">Movie</a>
                                    </li>
                                    <li><a th:href="@{http://localhost:8080/movies/pricing}">Pricing</a></li>
                                    <li><a th:href="@{../contact.html}">contacts</a></li>
                                    <li id="welcome" style="
                                                    font-size: 12px;
                                                    font-weight: 500;
                                                    text-transform: uppercase;
                                                    color: #f0f0f0;
                                                    padding: 38px 23px;
                                                    display: block;
                                                    line-height: 1;
                                                    position: relative;
                                                    z-index: 1;">未登录，请登录</li>
                                </ul>
                            </div>

                            <div class="header-action d-none d-md-block">
                                <ul>
                                    <!--                                            <li class="header-search"><a href="#" data-toggle="modal" data-target="#search-modal"><i class="fas fa-search"></i></a></li>-->
                                    <li id="header-search"><a href="#" ><i class="fas fa-search"></i></a></li>

                                    <div class="layout">
                                        <input type="text" class="search-box">
                                        <button id="search-confirm">确认</button>
                                    </div>

                                    <li class="header-lang">
                                        <form action="#">
                                            <div class="icon"><i class="flaticon-globe"></i></div>
                                            <select id="lang-dropdown">
                                                <option value="">En</option>
                                                <option value="">Au</option>
                                                <option value="">AR</option>
                                                <option value="">TU</option>
                                            </select>
                                        </form>
                                    </li>
                                    <!--                                            <li class="header-btn"><a href="#" class="btn">Sign In</a></li>-->
                                </ul>
                            </div>
                        </nav>
                    </div>

                    <style>
                        .layout{
                            width: 100vw;
                            height: 100vh;
                            background-color: rgba(0, 0, 0, 0.6);
                            transition: 0.5s linear;
                            display: flex;
                            justify-content: center;
                            align-items: center;
                            position: fixed;
                            z-index: 99;
                            top: 0;
                            left: 0;
                            opacity: 0;
                        }
                        #search-confirm{
                            height: 60px;
                            border: none;
                            border-radius: 5px;
                            width: 100px;
                            margin-left: 20px;
                            background-color: rgb(228, 216, 4);
                            color: #fff;
                            font-size: 20px;
                            font-weight: 500;
                        }
                        .search-box{
                            /*border: 1px red solid;*/
                            width: 400px;
                            height: 60px;
                            position: relative;
                            font-weight: 500;
                            font-size: 20px;
                            padding: 0 10px;
                        }
                        .search-box::before{
                            content: '123';
                            position: absolute;
                            right: 0;
                            top: 0;
                            /*border: 1px red solid;*/
                            width: 100px;
                            height: 100px;
                        }
                    </style>
                    <script>

                        const searchIcon = document.querySelector('#header-search');
                        const layout = document.querySelector('.layout');
                        const input = document.querySelector('.search-box');
                        const button = document.querySelector('#search-confirm');
                        const type = ["科幻", "剧情", "犯罪", "喜剧", "爱情", "奇幻", "战争", "音乐"];
                        const welcome = document.querySelector('#welcome');
                        const container = document.querySelector('.header-action.d-none.d-md-block').children[0];

                        layout.addEventListener('click', (event)=>{
                            // layout.style.display = 'none';
                            layout.style.opacity = 0;
                            layout.style.pointerEvents = 'none';

                        })

                        input.addEventListener('click', (event)=>{
                            event.stopPropagation();
                        })
                        button.addEventListener('click', (event)=>{
                            event.stopPropagation();
                            if (type.indexOf(input.value) === -1){
                                location.href = 'http://localhost:8080/movies/searchByName?name=' + input.value;
                            } else{
                                location.href = 'http://localhost:8080/movies/genre?genre=' + input.value + '&pageNum=1&pageSize=10';
                            }
                        })
                        searchIcon.addEventListener('click', ()=>{
                            layout.style.opacity = 1;
                            layout.style.pointerEvents = 'auto';
                        })

                        function check_status(){
                            const container = document.querySelector('.header-action.d-none.d-md-block').children[0];
                            fetch('http://localhost:8080/user/check')
                                .then(response => response.text())
                                .then(data => {
                                    if(data !== "用户未登陆") {
                                        fetch('http://localhost:8080/user/is_vip')
                                            .then(response => response.text())
                                            .then(data => {
                                                if(data === "true") {
                                                    welcome.innerText = "欢迎！VIP用户！"
                                                    // console.log(container)
                                                    container.removeChild(container.lastChild);
                                                    container.appendChild(createLi("退出登录"));
                                                }
                                                else {
                                                    welcome.innerText = "欢迎！普通用户！"
                                                    container.removeChild(container.lastChild)
                                                    container.appendChild(createLi("退出登录"));
                                                }
                                            })
                                            .catch(error => console.error('Error:', error));
                                    }
                                    else {
                                        welcome.innerText = "未登录！请登录！"
                                        container.removeChild(container.lastChild)
                                        container.appendChild(createLi("登录/注册"));
                                    }
                                })
                                .catch(error => console.error('Error:', error));
                        }
                        window.onload = () => {
                            check_status();
                        }
                        // check_status();

                        function createLi (text){
                            const li = document.createElement('li')
                            const a = document.createElement('a')
                            li.classList.add('header-btn')

                            fetch('http://localhost:8080/user/check')
                                .then(response => response.text())
                                .then(data => {
                                    if(data === "用户已登录"){
                                        console.log(data);
                                        li.removeEventListener('click', create_login);
                                        li.addEventListener('click', create_logout);
                                    } else{
                                        console.log(data);
                                        li.removeEventListener('click', create_logout);
                                        li.addEventListener('click', create_login);
                                    }
                                })
                                .catch(error => console.error('Error:', error));

                            a.href = '#'
                            a.classList.add('btn')
                            a.innerText = text;
                            li.appendChild(a);
                            return li
                        }


                        const loginBody = {
                            "username": "sjh",
                            "password": 123,
                        };

                        const loginvipBody = {
                            "username": "jc",
                            "password": 123,
                        };

                        const registerBody = {
                            "username": "sjh",
                            "password": 123,
                            "email": "1234567@qq.com",
                            "isVip": false
                        };

                        let target = loginBody;

                        function create_login(){
                            console.log("in");
                            if(target === loginvipBody) target = loginBody;
                            else target = loginvipBody;
                            // 发送请求
                            fetch('http://localhost:8080/user/login', {
                                method: 'POST', // 指定请求方法为POST
                                headers: {
                                    'Content-Type': 'application/json' // 设置请求头，指定内容类型为JSON
                                },
                                body: JSON.stringify(target) // 将请求体转换为JSON字符串
                            })
                                .then(response => response.text()) // 解析响应体为JSON格式
                                .then(data => {
                                    console.log(data); // 处理响应数据
                                    if (data === "登录成功"){
                                        fetch('http://localhost:8080/user/is_vip')
                                            .then(response => response.text())
                                            .then(data => {
                                                if(data === "true") {
                                                    welcome.innerText = '欢迎！VIP用户！';

                                                }
                                                else {
                                                    welcome.innerText = '欢迎！普通用户！';
                                                }
                                            })
                                            .catch(error => console.error('Error:', error));
                                        container.removeChild(container.lastChild)
                                        container.appendChild(createLi("退出登录"));

                                    }else{
                                        console.log(data);
                                        welcome.innerText = '未登录，请登录';
                                        console.warn("不存在该用户！请注册！")

                                        fetch('http://localhost:8080/user/register', {
                                            method: 'POST', // 指定请求方法为POST
                                            headers: {
                                                'Content-Type': 'application/json' // 设置请求头，指定内容类型为JSON
                                            },
                                            body: JSON.stringify(registerBody) // 将请求体转换为JSON字符串
                                        })
                                            .then(response => response.text()) // 解析响应体为JSON格式
                                            .then(data => {
                                                console.log(data); // 处理响应数据
                                            })
                                            .catch(error => {
                                                console.error('Error:', error); // 处理错误
                                            });

                                        container.removeChild(container.lastChild)
                                        container.appendChild(createLi("登录/注册"));
                                    }
                                })
                                .catch(error => {
                                    console.error('Error:', error); // 处理错误
                                });

                        }

                        function create_logout(){
                            console.log("out");
                            const btn = document.querySelector('.header-btn');

                            // fetch('http://localhost:8080/user/logout')
                            //     .then(response => response.text())
                            //     .then(data => {
                            //         console.log(data);
                            //         welcome.innerText = "未登录！请登录！"
                            //         container.removeChild(container.lastChild)
                            //         container.appendChild(createLi("登录/注册"));
                            //     })
                            //     .catch(error => console.error('Error:', error));

                            // 创建一个对象来表示请求体
                            const requestBody = {
                                username: "jc",
                                password: 123,
                                email: "12345@qq.com",
                                isVip: true
                            };

                            // 使用fetch API发送POST请求
                            fetch('http://localhost:8080/user/logout', {
                                method: 'POST', // 指定请求方法为POST
                                headers: {
                                    'Content-Type': 'application/json', // 设置请求头，表明发送的是JSON数据
                                },
                                body: JSON.stringify(requestBody) // 将请求体对象转换为JSON字符串
                            })
                                .then(response => response.text()) // 解析响应体为JSON
                                .then(data => {
                                    console.log(data);
                                    welcome.innerText = "未登录！请登录！"
                                    container.removeChild(container.lastChild)
                                    container.appendChild(createLi("登录/注册"));
                                })
                                .catch(error => {
                                    console.error('Error:', error); // 捕获并打印错误信息
                                });


                        }

                        // console.log(localStorage.getItem('islogin'))
                        // const btn = document.querySelector('.header-btn');
                        // // 判定登录状态
                        // if(localStorage.getItem('islogin')) btn.addEventListener('click', create_login);
                        // else btn.addEventListener('click', create_logout);

                    </script>

                    <!-- Mobile Menu  -->
                    <div class="mobile-menu">
                        <div class="close-btn"><i class="fas fa-times"></i></div>

                        <nav class="menu-box">
                            <div class="nav-logo"><a href="popular.html"><img src="/img/logo/logo.png" alt="" title=""></a>
                            </div>
                            <div class="menu-outer">
                                <!--Here Menu Will Come Automatically Via Javascript / Same Menu as in Header-->
                            </div>
                            <div class="social-links">
                                <ul class="clearfix">
                                    <li><a href="#"><span class="fab fa-twitter"></span></a></li>
                                    <li><a href="#"><span class="fab fa-facebook-square"></span></a></li>
                                    <li><a href="#"><span class="fab fa-pinterest-p"></span></a></li>
                                    <li><a href="#"><span class="fab fa-instagram"></span></a></li>
                                    <li><a href="#"><span class="fab fa-youtube"></span></a></li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-backdrop"></div>
                    <!-- End Mobile Menu -->

                    <!-- Modal Search -->
                    <div class="modal fade" id="search-modal" tabindex="-1" role="dialog" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <form id="search-form">
                                    <input type="text" placeholder="Search here...">
                                    <button onclick="performSearch()"><i class="fas fa-search"></i></button>
                                </form>
                            </div>
                        </div>
                    </div>
                    <!-- Modal Search-end -->

                    <script>
                        function performSearch(e) {

                            e.preventDefault()
                            let searchInput = document.getElementById('search-input').value;
                            let url = '/movies/genre?genre=' + encodeURIComponent(searchInput) + '&pageNum=1&pageSize=10';

                            // window.location.href = url;
                            // return false; // Prevent form submission
                        }
                    </script>

                </div>
            </div>
        </div>
    </div>
</header>
        <!-- header-area-end -->


        <!-- main-area -->
        <main>

            <!-- breadcrumb-area -->
<!--            <section class="breadcrumb-area breadcrumb-bg" data-background="/img/bg/breadcrumb_bg.jpg">-->
<!--                <div class="container">-->
<!--                    <div class="row">-->
<!--                        <div class="col-12">-->
<!--                            <div class="breadcrumb-content">-->
<!--                                <h2 class="title">Our <span>Movie</span></h2>-->
<!--                                <nav aria-label="breadcrumb">-->
<!--                                    <ol class="breadcrumb">-->
<!--                                        <li class="breadcrumb-item"><a href="popular.html">Home</a></li>-->
<!--                                        <li class="breadcrumb-item active" aria-current="page">Movie</li>-->
<!--                                    </ol>-->
<!--                                </nav>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </section>-->
            <!-- breadcrumb-area-end -->

            <!-- movie-area -->
            <section class="movie-area movie-bg" data-background="/img/bg/movie_bg.jpg">
                <div class="container">
                    <div class="row align-items-end mb-60">
                        <div class="col-lg-6">
                            <div class="section-title text-center text-lg-left">
                                <span class="sub-title">ONLINE STREAMING</span>
                                <h2 class="title">New Release Movies</h2>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="movie-page-meta">
                                <div class="tr-movie-menu-active text-center">
                                    <button class="active" data-filter="*">Animation</button>
                                    <button class="" data-filter=".cat-one">Movies</button>
                                    <button class="" data-filter=".cat-two">Romantic</button>
                                </div>
                                <form action="#" class="movie-filter-form">
                                    <select class="custom-select">
                                        <option selected>English</option>
                                        <option value="1">Blueray</option>
                                        <option value="2">4k Movie</option>
                                        <option value="3">Hd Movie</option>
                                    </select>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="row tr-movie-active">
                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-two" th:each="movie : ${reslist}">
                            <div class="movie-item movie-item-three mb-50">
                                <div class="movie-poster">
<!--                                    <img th:src="@{'../img/1.jpg'}" alt="">-->
                                    <img th:src="@{'../' + ${movie.coverUrl}}" alt="">
                                    <ul class="overlay-btn">
                                        <li class="rating">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                        </li>
                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>
                                        <li><a th:href="'http://localhost:8080/plays?videoId=' + ${movie.id} + '&userId=' + '9'" class="btn">Details</a></li>
                                    </ul>
                                </div>
                                <div class="movie-content">
                                    <div class="top">
                                        <h5 class="title"><a th:href="@{../movie-details.html}" th:text="${movie.title}">Women's Day</a></h5>
                                        <span class="date">2021</span>
                                    </div>
                                    <div class="bottom">
                                        <ul>
                                            <li><span class="quality">hd</span></li>
                                            <li>
                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>
                                                <span class="rating"><i class="fas fa-thumbs-up" th:text="' ' + ${movie.genre} + ' ' + ${movie.region}"></i></span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-one">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster02.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Perfect Match</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">4k</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-two">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster03.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Dog Woof</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">hd</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-one">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster04.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Easy Reach</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">hd</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-two">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster05.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Cooking</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">hd</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-one cat-two">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster06.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Hikaru Night</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">hd</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-one">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster07.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Life Quotes</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">hd</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                        <div class="col-xl-3 col-lg-4 col-sm-6 grid-item grid-sizer cat-one cat-two">-->
<!--                            <div class="movie-item movie-item-three mb-50">-->
<!--                                <div class="movie-poster">-->
<!--                                    <img src="/img/poster/ucm_poster08.jpg" alt="">-->
<!--                                    <ul class="overlay-btn">-->
<!--                                        <li class="rating">-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                            <i class="fas fa-star"></i>-->
<!--                                        </li>-->
<!--                                        <li><a href="https://www.youtube.com/watch?v=R2gbPxeNk2E" class="popup-video btn">Watch Now</a></li>-->
<!--                                        <li><a th:href="@{../movie-details.html}" class="btn">Details</a></li>-->
<!--                                    </ul>-->
<!--                                </div>-->
<!--                                <div class="movie-content">-->
<!--                                    <div class="top">-->
<!--                                        <h5 class="title"><a th:href="@{../movie-details.html}">The Beachball</a></h5>-->
<!--                                        <span class="date">2021</span>-->
<!--                                    </div>-->
<!--                                    <div class="bottom">-->
<!--                                        <ul>-->
<!--                                            <li><span class="quality">hd</span></li>-->
<!--                                            <li>-->
<!--                                                <span class="duration"><i class="far fa-clock"></i> 128 min</span>-->
<!--                                                <span class="rating"><i class="fas fa-thumbs-up"></i> 3.5</span>-->
<!--                                            </li>-->
<!--                                        </ul>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="pagination-wrap mt-30">
                                <nav>
                                    <ul>
                                        <li class="active"><a th:href="@{'http://localhost:8080/movies/genre?genre=' + ${reslist[0].genre} + '&pageNum=1&pageSize=10'}">1</a></li>
                                        <li><a th:href="@{'http://localhost:8080/movies/genre?genre=' + ${reslist[0].genre} + '&pageNum=2&pageSize=10'}">2</a></li>
                                        <li><a th:href="@{'http://localhost:8080/movies/genre?genre=' + ${reslist[0].genre} + '&pageNum=3&pageSize=10'}">3</a></li>
                                        <li><a th:href="@{'http://localhost:8080/movies/genre?genre=' + ${reslist[0].genre} + '&pageNum=4&pageSize=10'}">4</a></li>
                                        <li><a th:href="@{'http://localhost:8080/movies/genre?genre=' + ${reslist[0].genre} + '&pageNum=' + ${page.pageNum + 1} + '&pageSize=10'}">Next</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- movie-area-end -->

            <!-- newsletter-area -->
            <section class="newsletter-area newsletter-bg" data-background="/img/bg/newsletter_bg.jpg">
                <div class="container">
                    <div class="newsletter-inner-wrap">
                        <div class="row align-items-center">
                            <div class="col-lg-6">
                                <div class="newsletter-content">
                                    <h4>Trial Start First 30 Days.</h4>
                                    <p>Enter your email to create or restart your membership.</p>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <form action="#" class="newsletter-form">
                                    <input type="email" required placeholder="Enter your email">
                                    <button class="btn">get started</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- newsletter-area-end -->

        </main>
        <!-- main-area-end -->
<!--        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>-->
        <style>
    .layout{
        width: 100vw;
        height: 100vh;
        background-color: rgba(0, 0, 0, 0.6);
        transition: 0.5s linear;
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        z-index: 99;
        top: 0;
        left: 0;
        opacity: 0;
    }
    #search-confirm{
        height: 60px;
        border: none;
        border-radius: 5px;
        width: 100px;
        margin-left: 20px;
        background-color: rgb(228, 216, 4);
        color: #fff;
        font-size: 20px;
        font-weight: 500;
    }
    .search-box{
        /*border: 1px red solid;*/
        width: 400px;
        height: 60px;
        position: relative;
        font-weight: 500;
        font-size: 20px;
        padding: 0 10px;
    }
    .search-box::before{
        content: '123';
        position: absolute;
        right: 0;
        top: 0;
        /*border: 1px red solid;*/
        width: 100px;
        height: 100px;
    }
</style>
        <script>
            const searchIcon = document.querySelector('#header-search');
            const layout = document.querySelector('.layout');
            const input = document.querySelector('.search-box');
            const button = document.querySelector('#search-confirm');
            const type = ["科幻", "剧情", "犯罪", "喜剧", "爱情", "奇幻", "战争", "音乐"];
            const welcome = document.querySelector('#welcome');
            const container = document.querySelector('.header-action.d-none.d-md-block').children[0];

            layout.addEventListener('click', (event)=>{
                // layout.style.display = 'none';
                layout.style.opacity = 0;
                layout.style.pointerEvents = 'none';

            })

            input.addEventListener('click', (event)=>{
                event.stopPropagation();
            })
            button.addEventListener('click', (event)=>{
                event.stopPropagation();
                if (type.indexOf(input.value) === -1){
                    location.href = 'http://localhost:8080/movies/searchByName?name=' + input.value;
                } else{
                    location.href = 'http://localhost:8080/movies/genre?genre=' + input.value + '&pageNum=1&pageSize=10';
                }
            })
            searchIcon.addEventListener('click', ()=>{
                layout.style.opacity = 1;
                layout.style.pointerEvents = 'auto';
            })

            function check_status(){
                const container = document.querySelector('.header-action.d-none.d-md-block').children[0];
                fetch('http://localhost:8080/user/check')
                    .then(response => response.text())
                    .then(data => {
                        if(data !== "用户未登陆") {
                            fetch('http://localhost:8080/user/is_vip')
                                .then(response => response.text())
                                .then(data => {
                                    if(data === "true") {
                                        welcome.innerText = "欢迎！VIP用户！"
                                        // console.log(container)
                                        container.removeChild(container.lastChild);
                                        container.appendChild(createLi("退出登录"));
                                    }
                                    else {
                                        welcome.innerText = "欢迎！普通用户！"
                                        container.removeChild(container.lastChild)
                                        container.appendChild(createLi("退出登录"));
                                    }
                                })
                                .catch(error => console.error('Error:', error));
                        }
                        else {
                            welcome.innerText = "未登录！请登录！"
                            container.removeChild(container.lastChild)
                            container.appendChild(createLi("登录/注册"));
                        }
                    })
                    .catch(error => console.error('Error:', error));
            }
            window.onload = () => {
                check_status();
            }
            // check_status();

            function createLi (text){
                const li = document.createElement('li')
                const a = document.createElement('a')
                li.classList.add('header-btn')

                fetch('http://localhost:8080/user/check')
                    .then(response => response.text())
                    .then(data => {
                        if(data === "用户已登录"){
                            console.log(data);
                            li.removeEventListener('click', create_login);
                            li.addEventListener('click', create_logout);
                        } else{
                            console.log(data);
                            li.removeEventListener('click', create_logout);
                            li.addEventListener('click', create_login);
                        }
                    })
                    .catch(error => console.error('Error:', error));

                a.href = '#'
                a.classList.add('btn')
                a.innerText = text;
                li.appendChild(a);
                return li
            }


            const loginBody = {
                "username": "sjh",
                "password": 123,
            };

            const loginvipBody = {
                "username": "jc",
                "password": 123,
            };

            const registerBody = {
                "username": "sjh",
                "password": 123,
                "email": "1234567@qq.com",
                "isVip": false
            };

            let target = loginBody;

            function create_login(){
                console.log("in");
                if(target === loginvipBody) target = loginBody;
                else target = loginvipBody;
                // 发送请求
                fetch('http://localhost:8080/user/login', {
                    method: 'POST', // 指定请求方法为POST
                    headers: {
                        'Content-Type': 'application/json' // 设置请求头，指定内容类型为JSON
                    },
                    body: JSON.stringify(target) // 将请求体转换为JSON字符串
                })
                    .then(response => response.text()) // 解析响应体为JSON格式
                    .then(data => {
                        console.log(data); // 处理响应数据
                        if (data === "登录成功"){
                            fetch('http://localhost:8080/user/is_vip')
                                .then(response => response.text())
                                .then(data => {
                                    if(data === "true") {
                                        welcome.innerText = '欢迎！VIP用户！';

                                    }
                                    else {
                                        welcome.innerText = '欢迎！普通用户！';
                                    }
                                })
                                .catch(error => console.error('Error:', error));
                            container.removeChild(container.lastChild)
                            container.appendChild(createLi("退出登录"));

                        }else{
                            console.log(data);
                            welcome.innerText = '未登录，请登录';
                            console.warn("不存在该用户！请注册！")

                            fetch('http://localhost:8080/user/register', {
                                method: 'POST', // 指定请求方法为POST
                                headers: {
                                    'Content-Type': 'application/json' // 设置请求头，指定内容类型为JSON
                                },
                                body: JSON.stringify(registerBody) // 将请求体转换为JSON字符串
                            })
                                .then(response => response.text()) // 解析响应体为JSON格式
                                .then(data => {
                                    console.log(data); // 处理响应数据
                                })
                                .catch(error => {
                                    console.error('Error:', error); // 处理错误
                                });

                            container.removeChild(container.lastChild)
                            container.appendChild(createLi("登录/注册"));
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error); // 处理错误
                    });

            }

            function create_logout(){
                console.log("out");
                const btn = document.querySelector('.header-btn');

                // fetch('http://localhost:8080/user/logout')
                //     .then(response => response.text())
                //     .then(data => {
                //         console.log(data);
                //         welcome.innerText = "未登录！请登录！"
                //         container.removeChild(container.lastChild)
                //         container.appendChild(createLi("登录/注册"));
                //     })
                //     .catch(error => console.error('Error:', error));

                // 创建一个对象来表示请求体
                const requestBody = {
                    username: "jc",
                    password: 123,
                    email: "12345@qq.com",
                    isVip: true
                };

                // 使用fetch API发送POST请求
                fetch('http://localhost:8080/user/logout', {
                    method: 'POST', // 指定请求方法为POST
                    headers: {
                        'Content-Type': 'application/json', // 设置请求头，表明发送的是JSON数据
                    },
                    body: JSON.stringify(requestBody) // 将请求体对象转换为JSON字符串
                })
                    .then(response => response.text()) // 解析响应体为JSON
                    .then(data => {
                        console.log(data);
                        welcome.innerText = "未登录！请登录！"
                        container.removeChild(container.lastChild)
                        container.appendChild(createLi("登录/注册"));
                    })
                    .catch(error => {
                        console.error('Error:', error); // 捕获并打印错误信息
                    });


            }


        </script>

        <!-- footer-area -->
        <footer>
            <div class="footer-top-wrap">
                <div class="container">
                    <div class="footer-menu-wrap">
                        <div class="row align-items-center">
                            <div class="col-lg-3">
                                <div class="footer-logo">
                                    <a href="popular.html"><img src="/img/logo/logo.png" alt=""></a>
                                </div>
                            </div>
                            <div class="col-lg-9">
                                <div class="footer-menu">
                                    <nav>
                                        <ul class="navigation">
                                            <li><a href="popular.html">Home</a></li>
                                            <li><a href="popular.html">Movie</a></li>
                                            <li><a href="popular.html">tv show</a></li>
                                            <li><a href="popular.html">pages</a></li>
                                            <li><a href="pricing.html">Pricing</a></li>
                                        </ul>
                                        <div class="footer-search">
                                            <form action="#">
                                                <input type="text" placeholder="Find Favorite Movie">
                                                <button><i class="fas fa-search"></i></button>
                                            </form>
                                        </div>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="footer-quick-link-wrap">
                        <div class="row align-items-center">
                            <div class="col-md-7">
                                <div class="quick-link-list">
                                    <ul>
                                        <li><a href="#">FAQ</a></li>
                                        <li><a href="#">Help Center</a></li>
                                        <li><a href="#">Terms of Use</a></li>
                                        <li><a href="#">Privacy</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="footer-social">
                                    <ul>
                                        <li><a href="#"><i class="fab fa-facebook-f"></i></a></li>
                                        <li><a href="#"><i class="fab fa-twitter"></i></a></li>
                                        <li><a href="#"><i class="fab fa-pinterest-p"></i></a></li>
                                        <li><a href="#"><i class="fab fa-linkedin-in"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="copyright-wrap">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-6 col-md-6">
                            <div class="copyright-text">
                                <p>Copyright &copy; 2021. All Rights Reserved By <a href="http://www.bootstrapmb.com/">bootstrapmb</a></p>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6">
                            <div class="payment-method-img text-center text-md-right">
                                <img src="/img/images/card_img.png" alt="img">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- footer-area-end -->





		<!-- JS here -->
<!--        <script src="js/vendor/jquery-3.6.0.min.js"></script>-->
<!--        <script src="js/popper.min.js"></script>-->
<!--        <script src="js/bootstrap.min.js"></script>-->
<!--        <script src="js/isotope.pkgd.min.js"></script>-->
<!--        <script src="js/imagesloaded.pkgd.min.js"></script>-->
<!--        <script src="js/jquery.magnific-popup.min.js"></script>-->
<!--        <script src="js/owl.carousel.min.js"></script>-->
<!--        <script src="js/jquery.odometer.min.js"></script>-->
<!--        <script src="js/jquery.appear.js"></script>-->
<!--        <script src="js/slick.min.js"></script>-->
<!--        <script src="js/ajax-form.js"></script>-->
<!--        <script src="js/wow.min.js"></script>-->
<!--        <script src="js/aos.js"></script>-->
<!--        <script src="js/plugins.js"></script>-->
<!--        <script src="js/main.js"></script>-->

            <!-- JS here -->

            <script th:src="@{/js/vendor/jquery-3.6.0.min.js}"></script>
            <script th:src="@{/js/bootstrap.min.js}"></script>
            <script th:src="@{/js/popper.min.js}"></script>
            <script th:src="@{/js/owl.carousel.min.js}"></script>
            <script th:src="@{/js/isotope.pkgd.min.js}"></script>
            <script th:src="@{/js/aos.js}"></script>
            <script th:src="@{/js/slick.min.js}"></script>
            <script th:src="@{/js/ajax-form.js}"></script>
            <script th:src="@{/js/jquery.odometer.min.js}"></script>
            <script th:src="@{/js/wow.min.js}"></script>
            <script th:src="@{/js/jquery.appear.js}"></script>
            <script th:src="@{/js/imagesloaded.pkgd.min.js}"></script>
            <script th:src="@{/js/jquery.magnific-popup.min.js}"></script>
            <script th:src="@{/js/plugins.js}"></script>
            <script th:src="@{/js/main.js}"></script>
    </body>
</html>
